<!DOCTYPE html> <html lang="en-US"> <head> <meta charset="UTF-8"> <meta http-equiv="X-UA-Compatible" content="IE=Edge"> <link rel="shortcut icon" href="../../../favicon.ico" type="image/x-icon"> <link rel="stylesheet" href="../../../assets/css/just-the-docs-default.css"> <script async src="https://www.googletagmanager.com/gtag/js?id=UA-2724382-16"></script> <script> window.dataLayer = window.dataLayer || []; function gtag(){dataLayer.push(arguments);} gtag('js', new Date()); gtag('config', 'UA-2724382-16'); </script> <script type="text/javascript" src="../../../assets/js/vendor/lunr.min.js"></script> <script type="text/javascript" src="../../../assets/js/just-the-docs.js"></script> <meta name="viewport" content="width=device-width, initial-scale=1"> <!-- Begin Jekyll SEO tag v2.8.0 --> <title>Building and Running on PIC32MZ Embedded Graphics with Stacked DRAM (DA) Starter Kit (Crypto) | Microchip MPLAB Harmony USB Bootloader Applications help</title> <meta name="generator" content="Jekyll v3.9.2" /> <meta property="og:title" content="Building and Running on PIC32MZ Embedded Graphics with Stacked DRAM (DA) Starter Kit (Crypto)" /> <meta property="og:locale" content="en_US" /> <meta name="description" content="Harmony 3 USB Bootloader Applications package" /> <meta property="og:description" content="Harmony 3 USB Bootloader Applications package" /> <link rel="canonical" href="../../../apps/usb_live_update/docs/readme_pic32mz_das_sk.html" /> <meta property="og:url" content="../../../apps/usb_live_update/docs/readme_pic32mz_das_sk.html" /> <meta property="og:site_name" content="Microchip MPLAB Harmony USB Bootloader Applications help" /> <meta property="og:type" content="website" /> <meta name="twitter:card" content="summary" /> <meta property="twitter:title" content="Building and Running on PIC32MZ Embedded Graphics with Stacked DRAM (DA) Starter Kit (Crypto)" /> <script type="application/ld+json"> {"@context":"https://schema.org","@type":"WebPage","description":"Harmony 3 USB Bootloader Applications package","headline":"Building and Running on PIC32MZ Embedded Graphics with Stacked DRAM (DA) Starter Kit (Crypto)","publisher":{"@type":"Organization","logo":{"@type":"ImageObject","url":"../../assets/images/vendor/microchip_mplab_harmony_logo_150_transparent.png"}},"url":"../../../apps/usb_live_update/docs/readme_pic32mz_das_sk.html"}</script> <!-- End Jekyll SEO tag --> </head> <body> <svg xmlns="http://www.w3.org/2000/svg" style="display: none;"> <symbol id="svg-link" viewBox="0 0 24 24"> <title>Link</title> <svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="feather feather-link"> <path d="M10 13a5 5 0 0 0 7.54.54l3-3a5 5 0 0 0-7.07-7.07l-1.72 1.71"></path><path d="M14 11a5 5 0 0 0-7.54-.54l-3 3a5 5 0 0 0 7.07 7.07l1.71-1.71"></path> </svg> </symbol> <symbol id="svg-search" viewBox="0 0 24 24"> <title>Search</title> <svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="feather feather-search"> <circle cx="11" cy="11" r="8"></circle><line x1="21" y1="21" x2="16.65" y2="16.65"></line> </svg> </symbol> <symbol id="svg-menu" viewBox="0 0 24 24"> <title>Menu</title> <svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="feather feather-menu"> <line x1="3" y1="12" x2="21" y2="12"></line><line x1="3" y1="6" x2="21" y2="6"></line><line x1="3" y1="18" x2="21" y2="18"></line> </svg> </symbol> <symbol id="svg-arrow-right" viewBox="0 0 24 24"> <title>Expand</title> <svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="feather feather-chevron-right"> <polyline points="9 18 15 12 9 6"></polyline> </svg> </symbol> <symbol id="svg-doc" viewBox="0 0 24 24"> <title>Document</title> <svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="feather feather-file"> <path d="M13 2H6a2 2 0 0 0-2 2v16a2 2 0 0 0 2 2h12a2 2 0 0 0 2-2V9z"></path><polyline points="13 2 13 9 20 9"></polyline> </svg> </symbol> </svg> <div class="side-bar"> <div class="site-header"> <a href="../../../index.html" class="site-title lh-tight"> <div class="site-logo"></div> </a> <a href="#" id="menu-button" class="site-button"> <svg viewBox="0 0 24 24" class="icon"><use xlink:href="#svg-menu"></use></svg> </a> </div> <nav role="navigation" aria-label="Main" id="site-nav" class="site-nav"> <ul class="nav-list"><li class="nav-list-item active"><a href="#" class="nav-list-expander"><svg viewBox="0 0 24 24"><use xlink:href="#svg-arrow-right"></use></svg></a><a href="../../../index.html" class="nav-list-link">USB Bootloader Applications</a><ul class="nav-list "><li class="nav-list-item "><a href="../../../apps/usb_device_hid_bootloader/readme.html" class="nav-list-link">USB Device HID Bootloader</a></li><li class="nav-list-item active"><a href="../../../apps/usb_live_update/readme.html" class="nav-list-link">USB Device HID Live Update</a></li><li class="nav-list-item "><a href="../../../apps/usb_host_msd_bootloader/readme.html" class="nav-list-link">USB Host MSD Bootloader</a></li></ul></li><li class="nav-list-item"><a href="#" class="nav-list-expander"><svg viewBox="0 0 24 24"><use xlink:href="#svg-arrow-right"></use></svg></a><a href="../../../apps/docs/readme_configure_application.html" class="nav-list-link">Application Configurations</a><ul class="nav-list "><li class="nav-list-item "><a href="../../../apps/docs/readme_configure_application_sam.html" class="nav-list-link">Application Configurations for CORTEX-M based MCUs</a></li><li class="nav-list-item "><a href="../../../apps/docs/readme_configure_application_pic32m.html" class="nav-list-link">Application Configurations for MIPS based MCUs</a></li></ul></li><li class="nav-list-item"><a href="#" class="nav-list-expander"><svg viewBox="0 0 24 24"><use xlink:href="#svg-arrow-right"></use></svg></a><a href="../../../apps/docs/readme_live_update_memory_layout.html" class="nav-list-link">Live Update Memory Layout</a><ul class="nav-list "><li class="nav-list-item "><a href="../../../apps/docs/readme_live_update_memory_layout_sam.html" class="nav-list-link">Live Update Memory Layout For CORTEX-M Based MCUs</a></li><li class="nav-list-item "><a href="../../../apps/docs/readme_live_update_memory_layout_pic32m.html" class="nav-list-link">Live Update Memory Layout For MIPS Based MCUs</a></li></ul></li><li class="nav-list-item"><a href="../../../release_notes.html" class="nav-list-link">Release notes</a></li><li class="nav-list-item"><a href="../../../mplab_harmony_license.html" class="nav-list-link">License</a></li></ul> </nav> <footer class="site-footer"> This site uses <a href="https://github.com/pmarsceill/just-the-docs">Just the Docs</a>, a documentation theme for Jekyll. </footer> </div> <div class="main" id="top"> <div id="main-header" class="main-header"> <div class="search"> <div class="search-input-wrap"> <input type="text" id="search-input" class="search-input" tabindex="0" placeholder="Search Microchip MPLAB Harmony USB Bootloader Applications help" aria-label="Search Microchip MPLAB Harmony USB Bootloader Applications help" autocomplete="off"> <label for="search-input" class="search-label"><svg viewBox="0 0 24 24" class="search-icon"><use xlink:href="#svg-search"></use></svg></label> </div> <div id="search-results" class="search-results"></div> </div> <nav aria-label="Auxiliary" class="aux-nav"> <ul class="aux-nav-list"> <li class="aux-nav-list-item"> <a href="https://support.microchip.com" class="site-button" > Obtain Support from Microchip </a> </li> </ul> </nav> </div> <div id="main-content-wrap" class="main-content-wrap"> <nav aria-label="Breadcrumb" class="breadcrumb-nav"> <ol class="breadcrumb-nav-list"> <li class="breadcrumb-nav-list-item"><a href="../../../index.html">USB Bootloader Applications</a></li> <li class="breadcrumb-nav-list-item"><a href="../../../apps/usb_live_update/readme.html">USB Device HID Live Update</a></li> <li class="breadcrumb-nav-list-item"><span>Building and Running on PIC32MZ Embedded Graphics with Stacked DRAM (DA) Starter Kit (Crypto)</span></li> </ol> </nav> <div id="main-content" class="main-content" role="main"> <p><a href="https://www.microchip.com"><img src="https://www.microchip.com/ResourcePackages/Microchip/assets/dist/images/logo.png" alt="MCHP" /></a></p> <h1 id="building-and-running-the-usb-live-update-applications"> <a href="#building-and-running-the-usb-live-update-applications" aria-labelledby="building-and-running-the-usb-live-update-applications" class="anchor-heading"><svg viewBox="0 0 16 16" aria-hidden="true"><use xlink:href="#svg-link"></use></svg></a> Building and Running the USB Live Update applications </h1> <h2 id="downloading-and-building-the-application"> <a href="#downloading-and-building-the-application" aria-labelledby="downloading-and-building-the-application" class="anchor-heading"><svg viewBox="0 0 16 16" aria-hidden="true"><use xlink:href="#svg-link"></use></svg></a> Downloading and building the application </h2> <p>To clone or download these application from Github,go to the <a href="https://github.com/Microchip-MPLAB-Harmony/bootloader_apps_usb">main page of this repository</a> and then click Clone button to clone this repo or download as zip file. This content can also be download using content manager by following <a href="https://github.com/Microchip-MPLAB-Harmony/contentmanager/wiki">these instructions</a></p> <p>Path of the application within the repository is <strong>apps/usb_live_update/</strong></p> <p>To build the application, refer to the following table and open the project using its IDE.</p> <h3 id="switcher-application"> <a href="#switcher-application" aria-labelledby="switcher-application" class="anchor-heading"><svg viewBox="0 0 16 16" aria-hidden="true"><use xlink:href="#svg-link"></use></svg></a> Switcher Application </h3> <div class="table-wrapper"><table> <thead> <tr> <th>Project Name</th> <th>Description</th> </tr> </thead> <tbody> <tr> <td>switcher/firmware/pic32mz_das_sk.X</td> <td>MPLABX Project for <a href="http://www.microchip.com/DevelopmentTools/ProductDetails/DM320010-C">PIC32MZ Embedded Graphics with Stacked DRAM (DA) Starter Kit (Crypto)</a></td> </tr> </tbody> </table></div> <h3 id="live-update-application"> <a href="#live-update-application" aria-labelledby="live-update-application" class="anchor-heading"><svg viewBox="0 0 16 16" aria-hidden="true"><use xlink:href="#svg-link"></use></svg></a> Live Update Application </h3> <div class="table-wrapper"><table> <thead> <tr> <th>Project Name</th> <th>Description</th> </tr> </thead> <tbody> <tr> <td>live_update_app/firmware/pic32mz_das_sk.X</td> <td>MPLABX Project for <a href="http://www.microchip.com/DevelopmentTools/ProductDetails/DM320010-C">PIC32MZ Embedded Graphics with Stacked DRAM (DA) Starter Kit (Crypto)</a></td> </tr> </tbody> </table></div> <h2 id="setting-up-pic32mz-embedded-graphics-with-stacked-dram-da-starter-kit-crypto"> <a href="#setting-up-pic32mz-embedded-graphics-with-stacked-dram-da-starter-kit-crypto" aria-labelledby="setting-up-pic32mz-embedded-graphics-with-stacked-dram-da-starter-kit-crypto" class="anchor-heading"><svg viewBox="0 0 16 16" aria-hidden="true"><use xlink:href="#svg-link"></use></svg></a> Setting up <a href="http://www.microchip.com/DevelopmentTools/ProductDetails/DM320010-C">PIC32MZ Embedded Graphics with Stacked DRAM (DA) Starter Kit (Crypto)</a> </h2> <ul> <li> <p>Connect a micro USB cable to the UART-USB port J5</p> </li> <li> <p>For programming, connect a micro USB cable to the USB Debug port J19</p> </li> <li> <p>Use the micro-A/B port J6 (which is located on the bottom side of the board) to connect the USB Device to the USB Host PC</p> </li> </ul> <h2 id="running-the-application"> <a href="#running-the-application" aria-labelledby="running-the-application" class="anchor-heading"><svg viewBox="0 0 16 16" aria-hidden="true"><use xlink:href="#svg-link"></use></svg></a> Running the Application </h2> <ol> <li> <p>Open the switcher application project <em>switcher/firmware/pic32mz_das_sk.X</em> in the IDE</p> </li> <li>Make sure that the <em>live_update_app/firmware/pic32mz_das_sk.X</em> is added as a loadable project to switcher application <ul> <li>As the Switcher application does not have any programming capabilities, Adding the <strong>live_update_app as loadable</strong> allows MPLAB X to create a <strong>unified hex file</strong> and program both these application in thier respective memory location based on the respective linker scripts</li> </ul> <p><img src="../../../apps/usb_live_update/docs/images/switcher_mplab_pic32mz_das_sk.png" alt="switcher_mplab_pic32mz_das_sk" /></p> </li> <li>Open the Terminal application (Ex.:Tera Term) on the computer to get live update application messages through UART once loaded</li> <li>Configure the serial port settings as follows: <ul> <li>Baud : 115200</li> <li>Data : 8 Bits</li> <li>Parity : None</li> <li>Stop : 1 Bit</li> <li>Flow Control : None</li> </ul> </li> <li> <p>Build and program the <strong>switcher</strong> application using the IDE</p> </li> <li><strong>LED3</strong> should start blinking once programming is completed and below message has to be displayed on the Console <ul> <li>You can see how the live update application was loaded in BANK 1 by IDE and switcher application jumped BANK 1 to run it</li> <li>HID Custom device with product ID <strong>3C</strong> will be enumerated on Host PC</li> </ul> <p><img src="../../../apps/usb_live_update/docs/images/usb_live_update_bank_1.png" alt="usb_live_update_bank_1" /></p> </li> <li>Launch the Unified Host application from below path <ul> <li>&lt;harmony3_path&gt;/bootloader/tools/UnifiedHost-*/UnifiedHost-*.jar</li> </ul> </li> <li>Configure the Unified host application <ul> <li> <p>Select the <strong>Device architecture</strong> and <strong>Protocol</strong> as shown below</p> <p><img src="../../../apps/docs/images/unified_host_config.png" alt="hostConfig" /></p> </li> <li> <p>Click on configure button and select the USB Device as <strong>3C</strong></p> <p><img src="../../../apps/docs/images/unified_host_usb_setting.png" alt="hostUSBSetting" /></p> </li> <li>Load the live update application hex file to be programmed using below option <ul> <li><em>&lt;harmony3_path&gt;/bootloader_apps_usb/apps/usb_live_update/live_update_app/firmware/pic32mz_das_sk.X/dist/pic32mz_das_sk/production/pic32mz_das_sk.X.production.hex</em></li> </ul> <p><img src="../../../apps/docs/images/unified_host_load_hex.png" alt="hostLoadHex" /></p> </li> <li> <p>Open the <strong>Console</strong> window of the host application to view application bootloading sequence</p> <p><img src="../../../apps/docs/images/unified_host_tools_console.png" alt="hostToolsConsole" /></p> </li> </ul> </li> <li>Click on <strong>Program Device</strong> button to program the loaded live update application hex file on to the device <ul> <li>You can note that throughout the programming sequence and after programming the <strong>LED3</strong> will be blinking as the application task is running along with bootloader task <strong>(Live Update Feature)</strong></li> </ul> <p><img src="../../../apps/docs/images/unified_host_program_device.png" alt="hostProgramDevice" /></p> </li> <li>Following snapshot shows output of successfully programming the test application <ul> <li>Ignore the Device Reset Messages from the host tool. The live update application ignores the reset command received and waits for a switch press to update serial number and reset</li> </ul> <p><img src="../../../apps/docs/images/unified_host_success.png" alt="hostSuccess" /></p> </li> <li>Press the Switch <strong>SW1</strong> to update serial of <strong>Inactive Bank</strong> and trigger reset. You should see below output on success <ul> <li>This step shows that the new firmware programmed in <strong>BANK 2</strong> is running which is mapped to lower region by switcher at reset</li> </ul> <p><img src="../../../apps/usb_live_update/docs/images/usb_live_update_bank_2.png" alt="usb_live_update_bank_2" /></p> </li> <li>Repeat Steps 9-11 for further updates and observe the Banks from which application is running at every update</li> </ol> <h2 id="configurations-to-be-noted"> <a href="#configurations-to-be-noted" aria-labelledby="configurations-to-be-noted" class="anchor-heading"><svg viewBox="0 0 16 16" aria-hidden="true"><use xlink:href="#svg-link"></use></svg></a> Configurations to be Noted </h2> <h3 id="switcher-application-1"> <a href="#switcher-application-1" aria-labelledby="switcher-application-1" class="anchor-heading"><svg viewBox="0 0 16 16" aria-hidden="true"><use xlink:href="#svg-link"></use></svg></a> Switcher Application </h3> <ul> <li>As we are using custom linker script for Switcher, the default linker file generation has to be disabled</li> </ul> <p><img src="../../../apps/usb_live_update/docs/images/switcher_config_pic32mz_das_sk.png" alt="switcher_config_pic32mz_das_sk" /></p> <h3 id="live-update-application-1"> <a href="#live-update-application-1" aria-labelledby="live-update-application-1" class="anchor-heading"><svg viewBox="0 0 16 16" aria-hidden="true"><use xlink:href="#svg-link"></use></svg></a> Live Update Application </h3> <ul> <li>Enable Live Update Option to configure USB Device HID bootloader in <strong>Live Update Mode</strong></li> </ul> <p><img src="../../../apps/usb_live_update/docs/images/live_update_app_config_pic32mz.png" alt="live_update_app_config_pic32mz" /></p> <ul> <li><strong>Normalize hex file:</strong> <ul> <li>Check the Normalize hex file option as shown below, as the Unified bootloader host application takes hex file as an input. Normalizing the hex file will make sure the data in the hex file is arranged sequentially.</li> </ul> </li> </ul> <p><img src="../../../apps/usb_live_update/docs/images/live_update_app_mplab_config_pic32mz.png" alt="live_update_app_mplab_config_pic32mz" /></p> <hr> <footer> <p class="text-small text-grey-dk-000 mb-0"><img src='https://raw.githubusercontent.com/wiki/Microchip-MPLAB-Harmony/Microchip-MPLAB-Harmony.github.io/images/microchip_logo.png' /><br />Copyright &copy; 2020 Microchip Technology.</p> <!-- <p class="text-small text-grey-dk-000 mb-0"><img src='../../../assets/images/vendor/microchip_logo.png' /><br /> Copyright &copy; 2022 Microchip Technology.</p> --> </footer> </div> </div> <div class="search-overlay"></div> </div> </body> </html>
